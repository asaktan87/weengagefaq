<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WeEngage Assistant</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="color-scheme" content="light dark" />
  <style>
    :root { --ring: 59 130 246; }
    .chat-message { animation: slideIn .25s ease-out; }
    @keyframes slideIn { from{opacity:0; transform:translateY(8px)} to{opacity:1; transform:translateY(0)} }
    .typing-indicator { animation: pulse 1.4s infinite; }
    @keyframes pulse { 0%,100%{opacity:.5} 50%{opacity:1} }
    mark { padding: 0 .15rem; border-radius: .25rem; }
  </style>
</head>
<body class="min-h-full bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-900 dark:to-slate-950">
  <div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <header class="text-center mb-8">
      <div id="brandBadge" class="inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 bg-blue-600">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
      </div>
      <h1 id="brandTitle" class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2">WeEngage Assistant</h1>
      <p id="brandSubtitle" class="text-gray-600 dark:text-gray-300">Get instant answers about the WeEngage survey</p>
    </header>

    <!-- Quick Categories -->
    <section class="mb-6">
      <h2 class="text-lg font-semibold text-gray-700 dark:text-gray-200 mb-3">Popular Topics</h2>
      <div id="categoryButtons" class="flex flex-wrap gap-2">
        <button onclick="selectCategory('employees')" class="px-4 py-2 bg-white dark:bg-slate-900 rounded-full text-sm font-medium text-gray-700 dark:text-gray-100 hover:bg-blue-50 dark:hover:bg-slate-800 hover:text-blue-600 transition-colors border border-gray-200 dark:border-gray-700">
          üë©‚Äçüíº Employees
        </button>
        <button onclick="selectCategory('managers')" class="px-4 py-2 bg-white dark:bg-slate-900 rounded-full text-sm font-medium text-gray-700 dark:text-gray-100 hover:bg-blue-50 dark:hover:bg-slate-800 hover:text-blue-600 transition-colors border border-gray-200 dark:border-gray-700">
          üë®‚Äçüíº Managers
        </button>
        <button onclick="selectCategory('hrbps')" class="px-4 py-2 bg-white dark:bg-slate-900 rounded-full text-sm font-medium text-gray-700 dark:text-gray-100 hover:bg-blue-50 dark:hover:bg-slate-800 hover:text-blue-600 transition-colors border border-gray-200 dark:border-gray-700">
          üß© HRBPs
        </button>
        <button onclick="selectCategory('production')" class="px-4 py-2 bg-white dark:bg-slate-900 rounded-full text-sm font-medium text-gray-700 dark:text-gray-100 hover:bg-blue-50 dark:hover:bg-slate-800 hover:text-blue-600 transition-colors border border-gray-200 dark:border-gray-700">
          üè≠ Production Site
        </button>
      </div>
    </section>

    <!-- Chat Interface -->
    <section aria-label="FAQ chat" class="bg-white dark:bg-slate-900 rounded-lg shadow-lg overflow-hidden">
      <!-- Chat Messages -->
      <div id="chatMessages" class="h-96 overflow-y-auto p-6 space-y-4" aria-live="polite">
        <div class="chat-message flex items-start space-x-3">
          <div class="w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 text-white" id="botAvatar" style="background:#2563eb">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
            </svg>
          </div>
          <div class="bg-gray-100 dark:bg-slate-800 rounded-lg px-4 py-3 max-w-md">
            <p class="text-gray-800 dark:text-gray-100">
              Hi! I‚Äôm your WeEngage Assistant. Choose a category above or type your question below.
            </p>
          </div>
        </div>
      </div>

      <!-- Input Area -->
      <div class="border-t border-gray-200 dark:border-gray-800 p-4">
        <form id="chatForm" class="flex gap-3" autocomplete="off">
          <label for="messageInput" class="sr-only">Your question</label>
          <input
            type="text"
            id="messageInput"
            placeholder="Ask your question here‚Ä¶"
            class="flex-1 border border-gray-300 dark:border-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--ring))] focus:border-transparent bg-white dark:bg-slate-800 text-gray-900 dark:text-gray-100"
            aria-label="Ask a question"
          />
          <button
            type="submit"
            class="px-5 py-2 rounded-lg font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--ring))]"
          >
            Send
          </button>
        </form>
        <div id="recentQ" class="mt-3 flex flex-wrap gap-2"></div>
      </div>
    </section>

    <!-- Suggested Questions -->
    <section class="mt-6">
      <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200 mb-3">Suggested Questions</h3>
      <div id="suggested" class="grid md:grid-cols-2 gap-3"></div>
    </section>
  </div>

  <script>
  // Ensure all JS runs after the DOM is ready
  window.addEventListener("DOMContentLoaded", () => {
    // ---------- PERSONALIZATION ----------
    const CONFIG = {
      companyName: "Straumann Group",
      subtitle: "Get instant answers about the WeEngage survey",
      primaryBg: "bg-blue-600",
      primaryRing: "59 130 246",
      contacts: { hr: "we-engage@straumann.com" },
    };

    const CATEGORY_LABELS = {
      employees: "Employees",
      managers: "Managers",
      hrbps: "HRBPs",
      production: "Production Site",
    };

    // ---------- FAQ DATA (your exact content) ----------
    const FAQ_DATA = [
      /* ===================== EMPLOYEES ===================== */
      { category:"employees", title:"What is the WeEngage survey for?", keywords:["purpose","weengage","what is","engagement","survey"], answer:`At Straumann Group, we truly want to understand what drives and inspires our people - what motivates you, how you feel about your work, and what makes you want to grow and stay with us.<br><br>Through our annual weEngage Survey, running since 2020, we listen to your voice. Your answers give us valuable insights into how we lead, collaborate, and nurture our culture. They help us identify what we‚Äôre doing well and where we can do even better - ensuring that our actions strengthen our shared well-being and keep us moving forward together on our Cultural Journey.` },
      { category:"employees", title:"What is the response deadline for 2025?", keywords:["deadline","dates","2025","open","close"], answer:`The survey can be conducted from Nov 3rd until Nov 17th.` },
      { category:"employees", title:"What is the period that I should consider when answering the survey?", keywords:["period","timeframe","reference","window"], answer:`The period that should be considered in this survey refers from November 2024 to the present moment.` },
      { category:"employees", title:"Who responds to the survey? Who is the target audience?", keywords:["who responds","eligibility","target","audience","qr","u-number","date of birth"], answer:`All employees are invited to answer the survey (including interns). Even if you are on maternity leave, vacation or out of office due to long-term sickness, you can respond the survey. You can also use the QR code provided on weEngage poster or HR, by inserting your U-number and date of birth in YYYY-MM-DD format.<br><br><strong>External/contingent populations and populations with employment status change are not eligible to answer the survey.</strong>` },
      { category:"employees", title:"What is engagement?", keywords:["engagement","think feel act","definition"], answer:`Engagement is the outcome of 3 dimensions: How our people THINK, FEEL and ACT. Engagement is more than just participation - it‚Äôs the feeling of truly belonging, of being part of something bigger than yourself. It‚Äôs the energy, passion, and purpose that connect us to our work, our colleagues, and our shared mission.<br><br>When we measure engagement, we‚Äôre not just looking at satisfaction scores ‚Äî we‚Äôre listening to the heartbeat of our company. We understand what motivates us, what inspires us to give our best, and how deeply we feel connected to the Straumann Group family.` },
      { category:"employees", title:"What is Simple, Confidential and 100% online means for weEngage?", keywords:["confidential","privacy","viva glint","online"], answer:`It is simple to access and complete, it is confidential and conducted entirely online by Viva GLINT. Please note that the survey is confidential, not anonymous. So what confidential means...<br><br>First of all data privacy and trust are key priorities for Viva GLINT. All responses are collected and protected, but the system is designed to prevent individual responses from being identifiable in reporting. Your individual responses will not be visible to others; instead, your answers will be grouped with those of others to provide accurate reporting for hierarchical / regional and global rollout.<br><br>Viva Glint, a Microsoft-owned employee engagement platform, is a reputable and trusted solution used by mid-sized to large enterprises, including organizations with over 250,000 employees‚Äîacross more than 150 countries and in over 50 languages. Recognized for its excellence, including being named to the Forbes Cloud 100 list, it is trusted by leading companies such as P&G, United Airlines and Hilton Hotels Worldwide.` },
      { category:"employees", title:"How is Culture defined in Straumann Group?", keywords:["culture","player & learner","magic triangle","core beliefs"], answer:`Culture in our company is defined as how we act and feel every day and it‚Äôs each of our responsibilities to take care of it. Culture is why many join us and stay with us. Our culture is based on our 3 core pillars, which are:<br>‚Ä¢ The Player & Learner mindset.<br>‚Ä¢ The Magic Triangle: I, WE and IT.<br>‚Ä¢ 7 core beliefs:<br>&nbsp;&nbsp;o Customer Obsession /Centricity.<br>&nbsp;&nbsp;o Entrepreneurial Mindset.<br>&nbsp;&nbsp;o Agility & Decisiveness.<br>&nbsp;&nbsp;o Taking Ownership.<br>&nbsp;&nbsp;o Passion for Learning.<br>&nbsp;&nbsp;o Psychological Safety.<br>&nbsp;&nbsp;o Drive Engagement.` },
      { category:"employees", title:"Who has access to the survey results?", keywords:["access","results","visibility","threshold"], answer:`Managers only see results from their own area. HR Business Partners and the Grow & Culture team have broader access. Managers can see results for their own team or area, as long as there are at least five responses from their team. And they see the comments from the survey if there are at least 10 responses from their team.` },
      { category:"employees", title:"What happens after WeEngage‚Äôs results are published?", keywords:["actions","after results","follow up"], answer:`After the survey‚Äôs end, the results are announced to managers and shared to employees. After that, we mapped actions that promote the culture and engagement altogether, as well plans aimed at improvement from critical points of each area. These actions could be defined as training sessions 1:1, feedback sessions, team meetings, re-creating our flowcharts and developing our communication channels etc.` },
      { category:"employees", title:"What organization should I think about when the questions refer to Straumann Group?", keywords:["organization","what to consider","i we it"], answer:`Straumann Group operates under the umbrella of a high-performance player learner culture, a set of core beliefs deeply incorporating the dimensions of I, We and It - these are also embedded in our programs and processes across the world ‚Äî meaning that whether you‚Äôre in a local branch or the headquarters, the same practices, beliefs and expectations apply worldwide. This alignment ensures that every team, regardless of geography, builds and experiences the same culture, standards of excellence, innovation, and care that define the Straumann Group brand.<br><br>From an employee‚Äôs perspective, being part of STMN Group means belonging to a truly international organization where collaboration and purpose go beyond borders. You feel part of a shared vision ‚Äî of unlocking the potential of people's lives‚Äî while working in an environment that fosters trust, respect, and continuous learning. The strength of the organization lies in this global unity combined with local expertise, making you both locally grounded and globally connected.` },
      { category:"employees", title:"When the question refers to ‚Äúmy manager‚Äù, who should I consider while answering?", keywords:["my manager","line manager","reporting"], answer:`Always consider who you are directly reporting to. This person is your reporting/line manager who is normally one level above you. You may check your organizational structure on TEAMS or please ask your local HRBP.` },
      { category:"employees", title:"If the question refers ‚Äúmy team‚Äù, who should I consider?", keywords:["my team","peers"], answer:`Your peers, who report to the same manager.` },
      { category:"employees", title:"I don‚Äôt have direct contact with our customers, how could I answer the questions that refer to them?", keywords:["customers","internal customers","support areas"], answer:`When we talk about customers, we must consider our internal customers too. Many support areas don‚Äôt have direct contact with our end customers (external customers), but they support other areas of the Company so that information flows and processes run efficiently. Therefore, when we are evaluating something related to customers, we must consider who are the people that we serve and support with our work.<br><br>Please also do not forget that even if your role is not customer-facing it doesn‚Äôt mean that your job does not have any effect on them. Every employee, with or without contacting customers, has a great impact on our products and services. For more information do not hesitate to ask your line manager more.` },
      { category:"employees", title:"When the question refers to Communication, should I consider communication between people or the corporate communication area?", keywords:["communication","people","corporate comms"], answer:`Always consider communication between people (between areas, team, leadership, etc.). WeEngage don‚Äôt evaluate specific areas/departments of the company.` },
      { category:"employees", title:"Which team or function should I think about when answering the Collaboration question on weEngage?", keywords:["collaboration","teams","functions"], answer:`Collaboration and teamwork are key to how each of us works. Think broadly. It is about how well you and your colleagues work together ‚Äî both within your own team and with other teams and functions across the organization. In other words:<br>‚Ä¢ Start with your immediate team ‚Äî the people you work with day-to-day.<br>‚Ä¢ Then widen the view to include other teams, departments and support functions you interact with (for example: Sales, Marketing, R&D, Operations, IT, Finance, HR, etc.), as well as external partners or stakeholders where relevant.<br>‚Ä¢ Focus on the cooperative behaviors you can influence: the quality and clarity of communication, how hand-offs are managed, mutual support and respect, shared goals and problem-solving, and how teams coordinate across functions.` },
      { category:"employees", title:"I‚Äôve recently changed area, how/who should I consider while answering?", keywords:["changed area","transfer","new role"], answer:`Your current line manager and peers.` },
      { category:"employees", title:"I‚Äôve become manager of a new team recently, who will evaluate me?", keywords:["new manager","evaluate"], answer:`Your new team.` },
      { category:"employees", title:"If I've only been in the area for a short time and don't have much knowledge, how should I answer?", keywords:["short time","limited knowledge","how to answer"], answer:`You should answer according to your experience, even in a short period.` },
      { category:"employees", title:"Unfortunately, I will be leaving the company in mid-November. Will I still be included in the survey?", keywords:["leaving","eligibility"], answer:`Yes, all Straumann Group employees as of the survey start date, except external employees, are eligible to participate in the survey.` },
      { category:"employees", title:"I don‚Äôt have corporate e-mail, how could I access the platform to answer the survey?", keywords:["no email","access","qr","card","u-number","date of birth"], answer:`In the case of employees who don't have an e-mail address, they will receive a printed card from their managers. On this card there will be a QR Code that must be accessed via the camera of the cell phone, but also an access link to use directly via the browser. For entities where printed cards are not available, employees will use the QR Codes provided on weEngage posters.<br><br>When accessing the QR Code or the link, the employee will have to log in to the system using the data provided on the card and will then be able to answer the survey as normal. (u-number & date of birth in YYYY-MM-DD format)<br><br>The card is individual and non-transferable and is given to each employee by name.` },
      { category:"employees", title:"Can I redo my survey if I‚Äôve forgotten something or want to change an answer?", keywords:["redo","retake","change answers"], answer:`You can take the survey again and as many times while it‚Äôs still open by logging in with your access details. Each time you do, you‚Äôll need to answer all the questions again, and only your latest submission will count.` },
      { category:"employees", title:"I‚Äôm on vacation/maternity leave, long-term sick leave, can I answer the survey?", keywords:["vacation","maternity","sick leave"], answer:`Yes, your login access will be sent by e-mail, and you can access to answer the survey if you want to. You can also use the QR code by inserting your U-number and date of birth in YYYY-MM-DD format.` },
      { category:"employees", title:"Can the survey link be accessed by a user/domain/email other than STM Group's?", keywords:["access","domain","external email"], answer:`No, access is exclusively via corporate e-mail. In the case of employees who do not have an e-mail address should use the QR code by adding their U-number and date of birth in YYYY-MM-DD format.` },
      { category:"employees", title:"My colleague accidentally deleted/did not receive the Viva GLINT survey link. Can I forward mine?", keywords:["lost link","forward","invite","viva glint"], answer:`No, any emails sent directly to your mailbox are intended for you. Viva GLINT sends reminder e-mails to individuals with the link frequently. They should reach out to their local HRPBs for assistance in case they are not receiving any e-mail from Viva GLINT.` },
      { category:"employees", title:"General Program Questions (contact)", keywords:["program questions","contact","we-engage"], answer:`For program-related questions not tied to access or data, contact the Grow team or weEngage project team. (<a class="underline" href="mailto:we-engage@straumann.com">we-engage@straumann.com</a>)` },

      /* ===================== MANAGERS ===================== */
      { category:"managers", title:"What happens after results are shared with managers?", keywords:["after results","actions","review"], answer:`Managers review results with HRBPs and the Grow & Culture team. They identify strengths, challenges, and define actions such as workshops, feedback sessions, or training. It is important to understand the business context of the results and what has changed since the previous year.` },
      { category:"managers", title:"Who will evaluate me if I am a new manager?", keywords:["new manager","evaluate"], answer:`Your current team will evaluate you, even if you‚Äôve just joined them irrespective of how long you have been with them.` },
      { category:"managers", title:"Who has access to survey results?", keywords:["access","results","visibility"], answer:`Managers only see results from their own area. HRBPs and the Grow & Culture team have broader access.` },
      { category:"managers", title:"How should I support employees without corporate e-mail?", keywords:["no email","support","access"], answer:`Provide them with their printed cards, explain the access process, and ensure they can complete the survey. If you still struggle to secure access, please send an e-mail to we-engage@straumann.com and someone will help you.` },
      { category:"managers", title:"How can I encourage participation?", keywords:["participation","engage","confidentiality"], answer:`Communicate the importance of the survey openly, provide time for employees to answer, and reassure them about confidentiality. Dedicate 10-15 minutes during your weekly team meetings to discuss weEngage, and feel free to review the questions together. You can also highlight actions taken this year that are related to weEngage.` },
      { category:"managers", title:"What should I do if employees have doubts about survey questions?", keywords:["doubts","questions","guide"], answer:`Guide them based on the instructions: consider their direct manager, internal customers, and current work context. Do not forget to share weEngage FAQs for Employees document, which can be found here.` },
      { category:"managers", title:"The recent news has caused uncertainty within my team. What steps should I take?", keywords:["uncertainty","news","psychological safety"], answer:`Please be open and arrange a casual meeting with your team to explain the situation and address any questions right away. Organize this meeting, either in person or virtually, in a timely manner to prevent employees from making their own assumptions. Be clear and honest about the situation and the reasons behind it. If necessary, you can invite your HRBP or GM to join the meeting. Let them know if they have any questions or doubts in their minds, they can always connect with you. It is on us leaders to create psychological safety where everyone can voice their concern. These BIG business decisions are made to ensure the ongoing success of our company, and it's important to take these precautions before any issues arise.` },
      { category:"managers", title:"I don‚Äôt know how to read & analyze my report, what can I do?", keywords:["report","analyze","help","welearn"], answer:`Global weEngage team and your HRBP will be happy to support you. In the mean time please check the online trainings on weLearn regarding weEngage Survey & Reports.` },
      { category:"managers", title:"What actions can managers take based on survey results?", keywords:["actions","follow up","plan"], answer:`Examples include team offsites, 1:1 session, feedback discussions, training initiatives, and other engagement activities. Make sure to align with your team with actions and encourage them to find the action plans among themselves.` },
      { category:"managers", title:"On production sites how can I manage allocating time for our team to respond to the survey?", keywords:["production","time allocation","shifts"], answer:`Please encourage employees at our production sites to take part in the survey. Some motivating ideas are shared with HRs already. They can respond to the survey using their personal cell phones by scanning the QR code, kiosks, or shared workstations that may be available. Organizing small groups at 15/20-minute intervals each day will help make sure everyone has the opportunity to complete the survey within their working hours and share about our culture and engagement.` },

      /* ===================== HRBPs ===================== */
      { category:"hrbps", title:"Scope | Target audience", keywords:["scope","target","eligibility","qr","u-number"], answer:`All employees are invited to answer the survey (including interns). Even if you are on maternity leave, vacation or out of office due to long-term sickness, you can respond the survey. You can also use the QR code provided on weEngage posters or HR, by inserting your U-number and date of birth in YYYY-MM-DD format.<br><br>External/contingent populations and populations with employment status changes are not eligible to answer the survey.` },
      { category:"hrbps", title:"Access to Results", keywords:["access","results","provisioning","managers"], answer:`‚Ä¢ HR Business Partners (HRBPs): Access to survey results can be provided only upon request. Please contact Janis Birrer to request access. Different demographics (e.g. Legal Entity) can be used as criteria for access provisioning.<br>‚Ä¢ Managers: Managers automatically receive access to the results of their teams through the system. The visibility is based on the roll-up structure defined in Employee Central (EC). This ensures that reporting lines are consistent, and results are allocated correctly.` },
      { category:"hrbps", title:"Distribution of the Survey", keywords:["invitations","missing invite","spam"], answer:`‚Ä¢ Survey Invitations: All employees should receive their personal invitation to participate in the engagement survey.<br>‚Ä¢ If an Invitation Is Missing:<br>&nbsp;&nbsp;o First, check the spam/junk folder to ensure the email was not filtered.<br>&nbsp;&nbsp;o If the invitation is still not found, HRBPs could contact Janis Birrer to manually resend the survey invitation to the employee.` },
      { category:"hrbps", title:"Visibility of Results", keywords:["threshold","comments","continuity"], answer:`‚Ä¢ Minimum Respondents for Results: To protect confidentiality, a manager will only see results if there are at least five respondents in their reporting line.<br>‚Ä¢ Minimum Comments for Qualitative Insights (Comments): Comments are only displayed when a minimum of ten comments have been submitted. This ensures anonymity and prevents identification of individual feedback.<br>‚Ä¢ Result Continuity: Survey results follow the manager across years, enabling trend analysis and ongoing tracking over time.` },
      { category:"hrbps", title:"Critical Data Checks", keywords:["employee central","ec","data","reporting lines","job architecture","tenure","dob","username"], answer:`The accuracy and usefulness of survey results heavily depend on the integrity of underlying HR data. The following elements must be verified in Employee Central (EC):<br>1. Reporting Lines<br>&nbsp;&nbsp;o Drive the visibility of results for managers.<br>&nbsp;&nbsp;o Incorrect reporting lines may lead to misallocated or inaccessible results.<br>2. Organizational Structure<br>&nbsp;&nbsp;o Includes Organization, Organizational Unit, and Department.<br>&nbsp;&nbsp;o Critical for granting correct access and ensuring reporting accuracy at different organizational levels.<br>3. Job Architecture<br>&nbsp;&nbsp;o Covers Job Family, Job Sub-Family, and Standard Job Title.<br>&nbsp;&nbsp;o Essential for comparative reporting, benchmarking, and demographic segmentation of results.<br>4. Tenure<br>&nbsp;&nbsp;o Used to analyze engagement levels across employee tenure groups.<br>5. Date of Birth (Generations)<br>&nbsp;&nbsp;o Enables generational analysis (e.g., Baby Boomers, Gen X, Millennials, Gen Z).<br>&nbsp;&nbsp;o Useful for understanding engagement drivers across age groups.<br>6. Username Availability in EC<br>&nbsp;&nbsp;o Every employee must have a valid username stored in Employee Central.<br>&nbsp;&nbsp;o Without it, access to the survey or results cannot be granted.` },
      { category:"hrbps", title:"Employees with External Managers", keywords:["external managers","hierarchy","roll-up"], answer:`If employees are reporting to contingent workers (externals not loaded to Viva Glint) the manager hierarchy is broken, and it is not possible to report on for this manager from a roll-up perspective. Even if employees have an external direct manager, their responses will be included in the roll-up analysis.` },
      { category:"hrbps", title:"Employees without e-mail Addresses on EC", keywords:["no email","ec","qr"], answer:`They can complete the survey by scanning the QR code and entering their u-Numbers along with the date of birth (YYYY-MM-DD) as recorded in EC.` },
      { category:"hrbps", title:"Support Model ‚Äì Access Provisioning", keywords:["access provisioning","contacts","janis birrer","niti khosla"], answer:`HRBPs needing system access should have the Grow Head request it by contacting Janis Birrer (janis.birrer@straumann.com) and copying Niti Khosla (niti.khosla@straumann.com) and sharing a description of the what target population (e.g. Legal Entity) the HRBP should have access.` },
      { category:"hrbps", title:"Data Issues in Employee Central", keywords:["data issues","h ris","support channels"], answer:`Report discrepancies via the standard HRIS/system support channels to ensure proper tracking and resolution.` },
      { category:"hrbps", title:"Invitation Issues", keywords:["invite issues","missing invite"], answer:`If an employee cannot access or does not receive a survey, the Grow Head should escalate to Janis Birrer with:<br>‚Ä¢ Employee name<br>‚Ä¢ Employee Username<br>‚Ä¢ Description of the issue` },
      { category:"hrbps", title:"General Program Questions (contact)", keywords:["program questions","contact","we-engage"], answer:`For program-related questions not tied to access or data, contact the Grow team or weEngage project team. (<a class="underline" href="mailto:we-engage@straumann.com">we-engage@straumann.com</a>)` },

      /* ===================== PRODUCTION SITE ===================== */
      { category:"production", title:"How can employees, without e-mail, access the survey?", keywords:["no email","qr","u-number","date of birth","card"], answer:`They can access the survey by scanning the QR code provided on weEngage poster or by HR and inserting their U-number and date of birth in YYYY-MM-DD format. For some regions employees will receive printed cards with a QR Code and login credentials. These are distributed personally by managers and are non-transferable.` },
      { category:"production", title:"Can employees access the survey from personal devices?", keywords:["personal device","mobile","phone"], answer:`Yes, they can use the QR Code or access link via any smart device.` },
      { category:"production", title:"What if an employee forgets or loses their access info-card / QR Code?", keywords:["lost card","lost qr","replacement"], answer:`They should quickly inform their manager, who will coordinate with HR, to arrange a replacement or to obtain the QR code and credentials again.` },
      { category:"production", title:"Can production employees conduct the survey during working hours?", keywords:["working hours","time allocation","shifts"], answer:`Yes, managers should allocate time so production employees can participate without impacting shifts.` },
      { category:"production", title:"Is participation mandatory?", keywords:["mandatory","voluntary"], answer:`Participation is voluntary, but we highly encourage all employees to respond, as your feedback helps guide improvements and foster a more engaged workplace.` },
      { category:"production", title:"Will production-specific issues be considered?", keywords:["production issues","considered"], answer:`Yes, feedback from production employees is essential and included in overall analysis.` },
      { category:"production", title:"Are survey responses from production employees treated differently?", keywords:["treated differently","confidential"], answer:`No. All responses are confidential and contribute equally to the overall results.` },
      { category:"production", title:"Concerns about confidentiality: Viva Glint policy", keywords:["viva glint","confidentiality","privacy","forbes cloud 100"], answer:`Viva Glint, a Microsoft-owned employee engagement platform, is a reputable and trusted solution used by mid-sized to large enterprises, including organizations with over 250,000 employees‚Äîacross more than 150 countries and in over 50 languages. Recognized for its excellence, including being given to the Forbes Cloud 100 list, it is trusted by leading companies such as P&G, United Airlines and Hilton Hotels Worldwide.<br><br>A core principle of Viva Glint is its strong commitment to confidentiality and data privacy. Microsoft ensures that individual responses are treated as confidential, meaning they are protected and never reported in a way that can identify specific individuals. To safeguard this confidentiality, the platform applies thresholds so that results are only shown in aggregated form, ensuring each person‚Äôs input contributes to meaningful insights without compromising personal privacy or trust.` },
      { category:"production", title:"What organization should I think about when the questions refer to Straumann Group?", keywords:["organization","what to consider"], answer:`Straumann Group operates under the umbrella of a high-performance player learner culture, a set of core beliefs deeply incorporating the dimensions of I, We and It - these are also embedded in our programs and processes across the world ‚Äî meaning that whether you‚Äôre in a local branch or the headquarters, the same practices, beliefs and expectations apply worldwide. This alignment ensures that every team, regardless of geography, builds and experiences the same culture, standards of excellence, innovation, and care that define the Straumann Group brand.<br><br>From an employee‚Äôs perspective, being part of STMN Group means belonging to a truly international organization where collaboration and purpose go beyond borders. You feel part of a shared vision ‚Äî of unlocking the potential of people's lives‚Äî while working in an environment that fosters trust, respect, and continuous learning. The strength of the organization lies in this global unity combined with local expertise, making you both locally grounded and globally connected.` },
      { category:"production", title:"Which team/function should I think about when answering the Collaboration question?", keywords:["collaboration","teams","functions"], answer:`Collaboration and teamwork are key to how each of us works. Think broadly. It is about how well you and your colleagues work together ‚Äî both within your own team and with other teams and functions across the organization.` },
      { category:"production", title:"General Program Questions (contact)", keywords:["program questions","contact","we-engage"], answer:`For program-related questions not tied to access or data, contact the Grow team or weEngage project team. (<a class="underline" href="mailto:we-engage@straumann.com">we-engage@straumann.com</a>)` },
    ];

    // Suggested questions
    const SUGGESTED = [
      "What is the WeEngage survey for?",
      "What is the response deadline for 2025?",
      "Who responds to the survey?",
      "How is Culture defined in Straumann Group?",
      "How can employees without e-mail access the survey?",
      "How can I encourage participation?",
      "Access to Results (HRBPs)",
    ];

    // ---------- UI refs ----------
    const el = {
      chat: document.getElementById("chatMessages"),
      form: document.getElementById("chatForm"),
      input: document.getElementById("messageInput"),
      suggested: document.getElementById("suggested"),
      recentQ: document.getElementById("recentQ"),
      brandTitle: document.getElementById("brandTitle"),
      brandSubtitle: document.getElementById("brandSubtitle"),
      brandBadge: document.getElementById("brandBadge"),
      botAvatar: document.getElementById("botAvatar"),
    };

    // Branding
    function applyBranding() {
      el.brandTitle.textContent = `WeEngage Assistant`;
      el.brandSubtitle.textContent = CONFIG.subtitle;
      document.documentElement.style.setProperty("--ring", CONFIG.primaryRing);
    }
    applyBranding();

    // Suggested questions
    (function renderSuggested() {
      el.suggested.innerHTML = "";
      SUGGESTED.forEach(q => {
        const btn = document.createElement("button");
        btn.className = "text-left p-3 bg-white dark:bg-slate-900 rounded-lg hover:bg-blue-50 dark:hover:bg-slate-800 transition-colors border border-gray-200 dark:border-gray-700";
        btn.innerHTML = `<span class="text-blue-600 font-medium">${q}</span>`;
        btn.addEventListener("click", () => askQuestion(q));
        el.suggested.appendChild(btn);
      });
    })();

    // Recent questions (persisted)
    const RECENT_KEY = "faq_recent_q";
    function addRecent(q) {
      const list = getRecent();
      if (q.trim().length < 3) return;
      if (list[0] === q) return;
      const next = [q, ...list.filter(x => x !== q)].slice(0, 6);
      localStorage.setItem(RECENT_KEY, JSON.stringify(next));
      renderRecent();
    }
    function getRecent() {
      try { return JSON.parse(localStorage.getItem(RECENT_KEY) || "[]"); } catch { return []; }
    }
    function renderRecent() {
      const rec = getRecent();
      el.recentQ.innerHTML = "";
      rec.forEach(q => {
        const b = document.createElement("button");
        b.type = "button";
        b.className = "text-xs md:text-sm px-3 py-1.5 rounded-full border border-gray-300 dark:border-gray-700 bg-white dark:bg-slate-900 text-gray-700 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-slate-800";
        b.textContent = q;
        b.addEventListener("click", () => askQuestion(q));
        el.recentQ.appendChild(b);
      });
    }
    renderRecent();

    // Chat rendering
    function addMessage(content, opts = { role: "bot" }) {
      const wrap = document.createElement("div");
      wrap.className = "chat-message flex items-start space-x-3";
      if (opts.role === "user") {
        wrap.innerHTML = `
          <div class="flex-1"></div>
          <div class="rounded-lg px-4 py-3 max-w-md text-white bg-blue-600">
            <p>${content}</p>
          </div>
          <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center flex-shrink-0" aria-hidden="true">
            <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
          </div>
        `;
      } else {
        wrap.innerHTML = `
          <div class="w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 text-white bg-blue-600" aria-hidden="true">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
            </svg>
          </div>
          <div class="bg-gray-100 dark:bg-slate-800 rounded-lg px-4 py-3 max-w-md">
            <p class="text-gray-800 dark:text-gray-100">${content}</p>
          </div>
        `;
      }
      el.chat.appendChild(wrap);
      el.chat.scrollTop = el.chat.scrollHeight;
      return wrap;
    }

    function showTyping() {
      const typing = document.createElement("div");
      typing.id = "typing";
      typing.className = "flex items-start space-x-3";
      typing.innerHTML = `
        <div class="w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 text-white bg-blue-600" aria-hidden="true">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
          </svg>
        </div>
        <div class="bg-gray-100 dark:bg-slate-800 rounded-lg px-4 py-3">
          <div class="typing-indicator text-gray-500 dark:text-gray-300">Thinking‚Ä¶</div>
        </div>
      `;
      el.chat.appendChild(typing);
      el.chat.scrollTop = el.chat.scrollHeight;
    }
    function removeTyping() {
      const t = document.getElementById("typing");
      if (t) t.remove();
    }

    // Search / matching
    const norm = s => s.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu, "");
    const INDEX = FAQ_DATA.map((item, id) => ({
      id,
      category: item.category,
      title: item.title,
      answer: item.answer,
      keywords: (item.keywords || []).map(norm),
    }));

    function tokenize(q) {
      return norm(q).split(/[^a-z0-9+]+/).filter(Boolean);
    }

    function scoreEntry(tokens, entry, categoryFilter = null) {
      const answerText = norm(entry.title + " " + entry.answer);
      let score = 0;
      for (const kw of entry.keywords) if (tokens.includes(kw)) score += 3;
      for (const t of tokens) if (t.length >= 4 && answerText.includes(t)) score += 1;
      if (categoryFilter && entry.category === categoryFilter) score += 2;
      return score;
    }

    function findBestAnswers(question, categoryFilter = null) {
      const tokens = tokenize(question);
      const scored = INDEX
        .map(e => ({ ...e, _score: scoreEntry(tokens, e, categoryFilter) }))
        .filter(e => e._score > 0)
        .sort((a, b) => b._score - a._score);
      return scored.slice(0, 3);
    }

    function highlight(text, question) {
      const terms = [...new Set(tokenize(question).filter(t => t.length >= 4))];
      let out = text;
      for (const t of terms) {
        const re = new RegExp(`(${t.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")})`, "gi");
        out = out.replace(re, "<mark class='bg-yellow-200 dark:bg-yellow-600/40'>$1</mark>");
      }
      return out;
    }

    // Behavior
    let lastCategory = null;

    function answerQuestion(question) {
      const hits = findBestAnswers(question, lastCategory);
      if (hits.length === 0) {
        return `I couldn‚Äôt find a specific answer. For program questions, email <a class="underline" href="mailto:${CONFIG.contacts.hr}">${CONFIG.contacts.hr}</a>.`;
      }
      const best = hits[0];
      let html = `<div class="space-y-3">
        <div>
          <div class="text-sm uppercase tracking-wide text-gray-500 dark:text-gray-400">${CATEGORY_LABELS[best.category] || best.category}</div>
          <div class="font-semibold text-gray-900 dark:text-gray-100">${best.title}</div>
          <div class="prose prose-sm dark:prose-invert max-w-none mt-1">${highlight(best.answer, question)}</div>
        </div>`;
      if (hits.length > 1) {
        html += `<div class="pt-2 border-t border-gray-200 dark:border-gray-800">
          <div class="text-sm text-gray-600 dark:text-gray-300 mb-1">Related:</div>
          <ul class="list-disc list-inside space-y-1 text-sm">` +
          hits.slice(1).map(h => `<li><button class="underline text-blue-600 hover:text-blue-700" onclick="askQuestion('${h.title.replace(/'/g, "\\'")}')">${h.title}</button></li>`).join("") +
          `</ul>
        </div>`;
      }
      html += `</div>`;
      return html;
    }

    // Events
    const form = document.getElementById("chatForm");
    const input = document.getElementById("messageInput");

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const q = input.value.trim();
      if (!q) return;
      addMessage(q.replace(/[&<>"']/g, c => ({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;" }[c])), { role: "user" });
      input.value = "";
      input.focus();
      addRecent(q);
      showTyping();
      setTimeout(() => {
        removeTyping();
        const html = answerQuestion(q);
        addMessage(html, { role: "bot" });
      }, 450);
    });

    function askQuestion(q) {
      input.value = q;
      form.dispatchEvent(new Event("submit"));
    }
    window.askQuestion = askQuestion;

    function selectCategory(cat) {
      lastCategory = cat;
      const msg = {
        employees: "Employees: ask about eligibility, confidentiality, access, timeframe, and more.",
        managers: "Managers: ask about reading reports, encouraging participation, and post-results actions.",
        hrbps: "HRBPs: ask about access provisioning, EC data checks, thresholds, and distribution.",
        production: "Production Site: ask about QR access, time allocation, confidentiality, and devices.",
      }[cat] || `You selected ${cat}. What would you like to know?`;
      addMessage(msg);
      input.focus();
    }
    window.selectCategory = selectCategory;

  }); // end DOMContentLoaded
  </script>
</body>
</html>
